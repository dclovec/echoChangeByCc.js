!function(a,b){"function"==typeof define&&define.amd?define(function(){return b()}):"object"==typeof exports?module.exports=b:a.echo=b()}(window,function(){"use strict";var c,d,e,f,g,h,i,a={},b=function(){},j=function(a){return null===a.offsetParent},k=function(a,b){if(j(a))return!1;var c=a.getBoundingClientRect();return c.right>=b.l&&c.bottom>=b.t&&c.left<=b.r&&c.top<=b.b},l=function(){(f||!d)&&(clearTimeout(d),d=setTimeout(function(){a.render(),d=null},e))};return a.init=function(d){var j,k,m,n;d=d||{},j=d.offset||0,k=d.offsetVertical||j,m=d.offsetHorizontal||j,n=function(a,b){return parseInt(a||b,10)},h=d.container||document.body,i=h!==document.body?h:window,c={t:n(d.offsetTop,k),b:n(d.offsetBottom,k),l:n(d.offsetLeft,m),r:n(d.offsetRight,m)},e=n(d.throttle,250),f=d.debounce!==!1,g=!!d.unload,b=d.callback||b,a.render(),document.addEventListener?(i.addEventListener("scroll",l,!1),i.addEventListener("load",l,!1)):(i.attachEvent("onscroll",l),i.attachEvent("onload",l))},a.render=function(){var f,i,l,d=document.querySelectorAll("img[data-echo], [data-echo-background]"),e=d.length,j={l:0-c.l,t:0-c.t,b:h.clientHeight+c.b,r:h.clientWidth+c.r};for(l=0;e>l;l++)i=d[l],k(i,j)?(g&&i.setAttribute("data-echo-placeholder",i.src),null!==i.getAttribute("data-echo-background")?i.style.backgroundImage="url("+i.getAttribute("data-echo-background")+")":i.src=i.getAttribute("data-echo"),g||(i.removeAttribute("data-echo"),i.removeAttribute("data-echo-background")),b(i,"load")):g&&(f=i.getAttribute("data-echo-placeholder"))&&(null!==i.getAttribute("data-echo-background")?i.style.backgroundImage="url("+f+")":i.src=f,i.removeAttribute("data-echo-placeholder"),b(i,"unload"));e||a.detach()},a.detach=function(){document.removeEventListener?i.removeEventListener("scroll",l):i.detachEvent("onscroll",l),clearTimeout(d)},a});